<!DOCTYPE html>
<html>
<head>
<style>
table {
  font-family: arial, sans-serif;
  border-collapse: collapse;
  width: 100%;
}

td, th {
  border: 1px solid #dddddd;
  text-align: left;
  padding: 8px;
}

tr:nth-child(even) {
  background-color: #dddddd;
}
</style>
</head>
<body>

<h2>Conix Demo: Edge Resource Manager</h2>

<h3 id='framework'></h3>

<form action="/start">
    <input type="submit" value="Start Tasks"/>
</form>
<br/>
<form action="/stop">
    <input type="submit" value="Stop Tasks"/>
</form>

<h3 id='numtasks'></h3>

<p id='tasks'></p>

<script>
function loadTasks(){
  var xmlHttp = new XMLHttpRequest();
  xmlHttp.onreadystatechange = function () {
    if (xmlHttp.readyState == 4 && xmlHttp.status == 200){
      var resp = JSON.parse(xmlHttp.responseText);
      if(resp.error) {
        document.getElementById('tasks').innerHTML = resp.error.toString();
      } else {
        document.getElementById('framework').innerHTML = `Framework: ${resp.framework.name}`
        var tableHTML = "<table><tr><th>ID</th><th>Name</th><th>Agent Assigned</th></tr>"
        for(var i =0; i<resp.tasks.length;i++) {
          var task = resp.tasks[i];
          tableHTML += `<tr><td>${task.task_id}</td><td>${task.name}</td><td>${task.agent_id}</td></tr>`
        }
        tableHTML += "</table>"
        document.getElementById('tasks').innerHTML = tableHTML
        document.getElementById('numtasks').innerHTML = `${resp.tasks.length} Tasks`
      }
    } 
  }
  xmlHttp.open("GET", '/tasks', true);
  xmlHttp.send(null);
}
loadTasks();
</script>

</body>
</html>

